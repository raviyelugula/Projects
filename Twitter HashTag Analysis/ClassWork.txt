require(twitteR)
require(tm)
require(stringr)
require(ggplot2)
require(qdap)
require(stringr)

tweets.df <- read.csv("TwitterData.csv")
tweets.df$created <- as.Date(tweets.df$created, format= "%d-%m-%y")
tweets.df$text <- genX(tweets.df$text, " <", ">")
myCorpus<- Corpus(VectorSource(tweets.df$text)) 
myCorpus <- tm_map(myCorpus, content_transformer(tolower))
removeURL <- function(x) gsub("http[^[:space:]]*", "", x)  
myCorpus <- tm_map(myCorpus, content_transformer(removeURL))
removeNumPunct <- function(x) gsub("[^[:alpha:][:space:]]*", "", x)   
myCorpus <- tm_map(myCorpus, content_transformer(removeNumPunct))
myStopWords<- c((stopwords('english')),c("rt", "use", "used", "via", "amp"))
myCorpus<- tm_map(myCorpus,removeWords , myStopWords) 
removeSingle <- function(x) gsub(" . ", " ", x)   
myCorpus <- tm_map(myCorpus, content_transformer(removeSingle))
myCorpus<- tm_map(myCorpus, stripWhitespace) 
myCorpusCopy<- myCorpus
# myCorpus<- myCorpusCopy
myCorpus<-tm_map(myCorpus, stemDocument)
writeLines(strwrap(myCorpus[[250]]$content,60))
stemCompletion2 <- function(x,dictionary) {
  x <- unlist(strsplit(as.character(x)," "))
  x <- x[x !=""]
  x <- stemCompletion(x, dictionary = dictionary)
  x <- paste(x, sep="", collapse=" ")
  PlainTextDocument(stripWhitespace(x))
}
# myCorpus <- lapply(myCorpus, stemCompletion2, dictionary=myCorpusCopy)
# myCorpus <- Corpus(VectorSource(myCorpus))
myCorpus <- lapply(myCorpus, stemCompletion, dictionary=myCorpusCopy)
myCorpus <- Corpus(VectorSource(myCorpus))
myCorpus <-tm_map(myCorpus, stemCompletion ,dictionary=myCorpusCopy)
writeLines(strwrap(myCorpus[[250]]$content, 60))


