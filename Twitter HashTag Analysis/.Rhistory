sentiment_df %>%
top_n(45,freq) %>%
mutate(x1 = reorder(word,freq)) %>%
ggplot(aes(x=x1, y= freq, fill = senti_sign)) +
geom_col(stat='identity') +
coord_flip()+
title('Lexicon wordwise frequency')
sentiment_df %>%
top_n(45,freq) %>%
mutate(x1 = reorder(word,freq)) %>%
ggplot(aes(x=x1, y= freq, fill = senti_sign)) +
geom_col(stat='identity') +
coord_flip()+
ggtitle('Lexicon based word frequency')
sentiment_df %>%
top_n(45,freq) %>%
mutate(x1 = reorder(word,freq)) %>%
ggplot(aes(x=x1, y= freq, fill = senti_sign)) +
geom_col(stat='identity') +
coord_flip()+
ggtitle('Lexicon based word frequency')+
xlab('Words')+ylab('Frequency')
sentiment_df %>%
top_n(45,freq) %>%
mutate(x1 = reorder(word,freq)) %>%
ggplot(aes(x=x1, y= freq, fill = senti_sign)) +
geom_col(stat='identity') +
coord_flip()+
facet_wrap(~senti_sign, scales = "free_x")+
ggtitle('Lexicon based word frequency')+
xlab('Words')+ylab('Frequency')
sentiment_df %>%
top_n(45) %>%
mutate(x1 = reorder(word,freq),
y1 = ifelse(senti_sign=='positive',freq,-freq)) %>%
ggplot(aes(x=x1, y= y1, fill = senti_sign)) +
geom_col(stat='identity') +
coord_flip()+
facet_wrap(~senti_sign, scales = "free_x")+
ggtitle('Lexicon based word frequency')+
xlab('Words')+ylab('Frequency')
sentiment_df %>%
top_n(40) %>%
mutate(x1 = reorder(word,freq),
y1 = ifelse(senti_sign=='positive',freq,-freq)) %>%
ggplot(aes(x=x1, y= y1, fill = senti_sign)) +
geom_col(stat='identity') +
coord_flip()+
facet_wrap(~senti_sign, scales = "free_x")+
ggtitle('Lexicon based word frequency')+
xlab('Words')+ylab('Frequency')
sentiment_df %>%
top_n(25) %>%
mutate(x1 = reorder(word,freq),
y1 = ifelse(senti_sign=='positive',freq,-freq)) %>%
ggplot(aes(x=x1, y= y1, fill = senti_sign)) +
geom_col(stat='identity') +
coord_flip()+
facet_wrap(~senti_sign, scales = "free_x")+
ggtitle('Lexicon based word frequency')+
xlab('Words')+ylab('Frequency')
sentiment_df %>%
top_n(20) %>%
mutate(x1 = reorder(word,freq),
y1 = ifelse(senti_sign=='positive',freq,-freq)) %>%
ggplot(aes(x=x1, y= y1, fill = senti_sign)) +
geom_col(stat='identity') +
coord_flip()+
facet_wrap(~senti_sign, scales = "free_x")+
ggtitle('Lexicon based word frequency')+
xlab('Words')+ylab('Frequency')
sentiment_df %>%
top_n(25) %>%
mutate(x1 = reorder(word,freq),
y1 = ifelse(senti_sign=='positive',freq,-freq)) %>%
ggplot(aes(x=x1, y= y1, fill = senti_sign)) +
geom_col(stat='identity') +
coord_flip()+
facet_wrap(~senti_sign, scales = "free_x")+
ggtitle('Lexicon based word frequency')+
xlab('Words')+ylab('Frequency')
sentiment_df %>%
top_n(25) %>%
mutate(x1 = reorder(word,freq),
y1 = ifelse(senti_sign=='positive',freq,-freq)) %>%
ggplot(aes(x=x1, y= y1, fill = senti_sign)) +
geom_col(stat='identity') +
coord_flip()+
facet_wrap(~senti_sign, scales = "free_x")+
ggtitle('Lexicon based word frequency')+
xlab('Words')+ylab('Frequency')
sentiment_df %>%
top_n(25) %>%
mutate(x1 = reorder(word,freq),
y1 = ifelse(senti_sign=='positive',freq,-freq)) %>%
ggplot(aes(x=x1, y= y1)) +
geom_col(stat='identity') +
coord_flip()+
facet_wrap(~senti_sign, scales = "free_x")+
ggtitle('Lexicon based word frequency')+
xlab('Words')+ylab('Frequency')
sentiment_df %>%
top_n(25) %>%
mutate(x1 = reorder(word,freq),
y1 = ifelse(senti_sign=='positive',freq,-freq)) %>%
ggplot(aes(x=x1, y= y1, fill = senti_sign)) +
geom_col(stat='identity') +
coord_flip()+
#facet_wrap(~senti_sign, scales = "free_x")+
ggtitle('Lexicon based word frequency')+
xlab('Words')+ylab('Frequency')
sentiment_df[1:3] %>%
top_n(25) %>%
mutate(x1 = reorder(word,freq),
y1 = ifelse(senti_sign=='positive',freq,-freq)) %>%
ggplot(aes(x=x1, y= y1, fill = senti_sign)) +
geom_col(stat='identity') +
coord_flip()+
#facet_wrap(~senti_sign, scales = "free_x")+
ggtitle('Lexicon based word frequency')+
xlab('Words')+ylab('Frequency')
sentiment_df[1:3] %>%
top_n(40) %>%
mutate(x1 = reorder(word,freq),
y1 = ifelse(senti_sign=='positive',freq,-freq)) %>%
ggplot(aes(x=x1, y= y1, fill = senti_sign)) +
geom_col(stat='identity') +
coord_flip()+
#facet_wrap(~senti_sign, scales = "free_x")+
ggtitle('Lexicon based word frequency')+
xlab('Words')+ylab('Frequency')
sentiment_df[1:3] %>%
top_n(40) %>%
mutate(x1 = reorder(word,freq),
y1 = ifelse(senti_sign=='positive',freq,-freq))
sentiment_df[1:2] %>%
top_n(40) %>%
mutate(x1 = reorder(word,freq),
y1 = ifelse(senti_sign=='positive',freq,-freq)) %>%
ggplot(aes(x=x1, y= y1, fill = senti_sign)) +
geom_col(stat='identity') +
coord_flip()+
#facet_wrap(~senti_sign, scales = "free_x")+
ggtitle('Lexicon based word frequency')+
xlab('Words')+ylab('Frequency')
sentiment_df[order_by(freq),]
sentiment_df[order_by(sentiment_df$freq),]
sentiment_df[order(sentiment_df$freq),]
sentiment_df[order(sentiment_df$freq,decreasing = T),]
sentiment_df=sentiment_df[order(sentiment_df$freq,decreasing = T),]
sentiment_df[1:3] %>%
top_n(40) %>%
mutate(x1 = reorder(word,freq),
y1 = ifelse(senti_sign=='positive',freq,-freq)) %>%
ggplot(aes(x=x1, y= y1, fill = senti_sign)) +
geom_col(stat='identity') +
coord_flip()+
#facet_wrap(~senti_sign, scales = "free_x")+
ggtitle('Lexicon based word frequency')+
xlab('Words')+ylab('Frequency')
sentiment_df[1:3] %>%
top_n(40) %>%
mutate(
y1 = ifelse(senti_sign=='positive',freq,-freq)) %>%
ggplot(aes(x=word, y= y1, fill = senti_sign)) +
geom_col(stat='identity') +
coord_flip()+
#facet_wrap(~senti_sign, scales = "free_x")+
ggtitle('Lexicon based word frequency')+
xlab('Words')+ylab('Frequency')
sentiment_df[1:3,40] %>%
mutate(
y1 = ifelse(senti_sign=='positive',freq,-freq)) %>%
ggplot(aes(x=word, y= y1, fill = senti_sign)) +
geom_col(stat='identity') +
coord_flip()+
#facet_wrap(~senti_sign, scales = "free_x")+
ggtitle('Lexicon based word frequency')+
xlab('Words')+ylab('Frequency')
sentiment_df[1:3,40] %>%
mutate(
y1 = ifelse(senti_sign=='positive',freq,-freq)) %>%
ggplot(aes(x=word, y= y1, fill = senti_sign)) +
geom_col(stat='identity') +
coord_flip()+
#facet_wrap(~senti_sign, scales = "free_x")+
ggtitle('Lexicon based word frequency')+
xlab('Words')+ylab('Frequency')
sentiment_df[1:3,40] %>%
mutate(y1 = ifelse(senti_sign=='positive',freq,-freq)) %>%
ggplot(aes(x=word, y= y1, fill = senti_sign)) +
geom_col(stat='identity') +
coord_flip()+
#facet_wrap(~senti_sign, scales = "free_x")+
ggtitle('Lexicon based word frequency')+
xlab('Words')+ylab('Frequency')
sentiment_df[40,1:3] %>%
mutate(
y1 = ifelse(senti_sign=='positive',freq,-freq)) %>%
ggplot(aes(x=word, y= y1, fill = senti_sign)) +
geom_col(stat='identity') +
coord_flip()+
#facet_wrap(~senti_sign, scales = "free_x")+
ggtitle('Lexicon based word frequency')+
xlab('Words')+ylab('Frequency')
sentiment_df[1:3] %>%
top_n(40) %>%
mutate(x1 = reorder(word,freq),
y1 = ifelse(senti_sign=='positive',freq,-freq)) %>%
ggplot(aes(x=x1, y= y1, fill = senti_sign)) +
geom_col(stat='identity') +
coord_flip()+
#facet_wrap(~senti_sign, scales = "free_x")+
ggtitle('Lexicon based word frequency')+
xlab('Words')+ylab('Frequency')
sentiment_df[1:3] %>%
top_n(40) %>%
mutate(x1 = reorder(word,freq),
y1 = ifelse(senti_sign=='positive',freq,-freq)) %>%
ggplot(aes(x=x1, y= y1, fill = senti_sign)) +
geom_col(stat='identity') +
coord_flip()+
#facet_wrap(~senti_sign, scales = "free_x")+
ggtitle('Lexicon based word frequency')+
xlab('Words')+ylab('Frequency')
sentiment_df = frequency_df %>%
inner_join(get_sentiments('bing'), by='word')
colnames(frequency_df) = c('word','freq')
require(tidytext)
require(dplyr)
sentiment_df = frequency_df %>%
inner_join(get_sentiments('bing'), by='word')
Tweets_Corpus_TDM = TermDocumentMatrix(Tweets_Corpus)
Tweets_Corpus_TDM_M = as.matrix(Tweets_Corpus_TDM)
termFrequency = rowSums(Tweets_Corpus_TDM_M)
termFrequency = sort(termFrequency,decreasing =T)
require(ggplot2)
frequency_df <- data.frame(term = names(termFrequency), freq= termFrequency)
ggplot(frequency_df[1:25,], aes(reorder(term, freq),freq)) +
theme_bw() +
geom_bar(stat = "identity") +
coord_flip() +
labs(list(title="Term Frequency Chart", x="Terms", y="Term Counts"))
index <- which(dimnames(Tweets_Corpus_TDM)$Terms %in% c("live", "people"))
as.matrix(Tweets_Corpus_TDM[index,21:60])
pal<- brewer.pal(4, "Dark2")
require(wordcloud)
wordcloud(words = names(termFrequency),
freq = termFrequency,
min.freq = 2,
random.order = F,
colors = pal,
max.words = 100)
Tweets_Corpus_DTM <- as.DocumentTermMatrix(Tweets_Corpus_TDM)
rowTotals <- apply(Tweets_Corpus_DTM , 1, sum)
NullDocs <- Tweets_Corpus_DTM[rowTotals==0, ]
Tweets_Corpus_DTM   <- Tweets_Corpus_DTM[rowTotals> 0, ]
if (length(NullDocs$dimnames$Docs) > 0) {
TT_dataframe <- TT_dataframe[-as.numeric(NullDocs$dimnames$Docs),]
}
require(topicmodels)
lda <- LDA(Tweets_Corpus_DTM, k = 5) # find 5 topic
term <- terms(lda, 7) # first 7 terms of every topic
term
topics<- topics(lda)
topics
topics_df<- data.frame(date=(TT_dataframe$created), topic = topics)
qplot(date, ..count.., data=topics_df,
geom ="density",
fill= term[topic],position="stack")
colnames(frequency_df) = c('word','freq')
require(tidytext)
require(dplyr)
sentiment_df = frequency_df %>%
inner_join(get_sentiments('bing'), by='word')
colnames(sentiment_df) = c(names(sentiment_df[1:2]),'senti_sign')
sentiment_df = sentiment_df %>%
inner_join(get_sentiments('afinn'),by='word')
sentiment_df = frequency_df %>%
inner_join(get_sentiments('bing'), by='word')
sentiment_df = sentiment_df %>%
inner_join(get_sentiments('afinn'),by='word')
sentiment_df %>%
top_n(40) %>%
mutate(x1 = reorder(word,freq),
y1 = ifelse(senti_sign=='positive',freq,-freq)) %>%
ggplot(aes(x=x1, y= y1, fill = senti_sign)) +
geom_col(stat='identity') +
coord_flip()+
#facet_wrap(~senti_sign, scales = "free_x")+
ggtitle('Lexicon based word frequency')+
xlab('Words')+ylab('Frequency')
sentiment_df %>%
top_n(40) %>%
mutate(x1 = reorder(word,freq),
y1 = ifelse(senti_sign=='positive',freq,-freq)) %>%
ggplot(aes(x=x1, y= y1, fill = sentiment)) +
geom_col(stat='identity') +
coord_flip()+
#facet_wrap(~senti_sign, scales = "free_x")+
ggtitle('Lexicon based word frequency')+
xlab('Words')+ylab('Frequency')
sentiment_df %>%
top_n(40) %>%
mutate(x1 = reorder(word,freq),
y1 = ifelse(sentiment=='positive',freq,-freq)) %>%
ggplot(aes(x=x1, y= y1, fill = sentiment)) +
geom_col(stat='identity') +
coord_flip()+
#facet_wrap(~senti_sign, scales = "free_x")+
ggtitle('Lexicon based word frequency')+
xlab('Words')+ylab('Frequency')
sentiment_df %>%
top_n(20) %>%
mutate(x1 = reorder(word,freq),
y1 = ifelse(sentiment=='positive',freq,-freq)) %>%
ggplot(aes(x=x1, y= y1, fill = sentiment)) +
geom_col(stat='identity') +
coord_flip()+
#facet_wrap(~senti_sign, scales = "free_x")+
ggtitle('Lexicon based word frequency')+
xlab('Words')+ylab('Frequency')
sentiment_df %>%
top_n(20,freq) %>%
mutate(x1 = reorder(word,freq),
y1 = ifelse(sentiment=='positive',freq,-freq)) %>%
ggplot(aes(x=x1, y= y1, fill = sentiment)) +
geom_col(stat='identity') +
coord_flip()+
#facet_wrap(~senti_sign, scales = "free_x")+
ggtitle('Lexicon based word frequency')+
xlab('Words')+ylab('Frequency')
sentiment_df %>%
top_n(25,freq) %>%
mutate(x1 = reorder(word,freq),
y1 = ifelse(sentiment=='positive',freq,-freq)) %>%
ggplot(aes(x=x1, y= y1, fill = sentiment)) +
geom_col(stat='identity') +
coord_flip()+
#facet_wrap(~senti_sign, scales = "free_x")+
ggtitle('Lexicon based word frequency')+
xlab('Words')+ylab('Frequency')
sentiment_df %>%
top_n(25,freq) %>%
mutate(x1 = reorder(word,freq),
y1 = ifelse(sentiment=='positive',freq,-freq)) %>%
ggplot(aes(x=x1, y= y1, fill = sentiment)) +
geom_col(stat='identity') +
coord_flip()+
facet_wrap(~sentiment, scales = "free_x")+
ggtitle('Lexicon based word frequency')+
xlab('Words')+ylab('Frequency')
Emotion_sentiment_df = frequency_df %>%
inner_join(get_sentiments('nrc'), by='word')
View(Emotion_sentiment_df)
Emotion_sentiment_df %>%
count(word,sentiment) %>%
group_by(sentiment) %>%
top_n(10) %>%
ungroup() %>%
mutate(word = reorder(word, n)) %>%
ggplot(aes(x = word, y = n , fill  = sentiment)) +
geom_col(show.legend = FALSE) +
facet_wrap(~ sentiment, scales = "free") +
coord_flip()
Emotion_sentiment_df %>%
count(word,sentiment) %>%
group_by(sentiment) %>%
top_n(10) %>%
ungroup() %>%
mutate(word = reorder(word, freq)) %>%
ggplot(aes(x = word, y = freq , fill  = sentiment)) +
geom_col(show.legend = FALSE) +
facet_wrap(~ sentiment, scales = "free") +
coord_flip()
Emotion_sentiment_df %>%
count(word,sentiment) %>%
group_by(sentiment) %>%
top_n(10) %>%
ungroup() %>%
mutate(word = reorder(word, freq)) %>%
ggplot(aes(x = word, y = freq , fill  = sentiment)) +
geom_col(show.legend = FALSE) +
facet_wrap(~ sentiment, scales = "free") +
coord_flip()
Emotion_sentiment_df %>%
count(word,sentiment) %>%
group_by(sentiment) %>%
top_n(10) %>%
ungroup() %>%
mutate(word = reorder(word, n)) %>%
ggplot(aes(x = word, y = freq , fill  = sentiment)) +
geom_col(show.legend = FALSE) +
facet_wrap(~ sentiment, scales = "free") +
coord_flip()
Emotion_sentiment_df %>%
count(word,sentiment) %>%
group_by(sentiment) %>%
top_n(10) %>%
ungroup()
Emotion_sentiment_df %>%
sum(freq) %>%
group_by(sentiment) %>%
top_n(10) %>%
ungroup() %>%
mutate(word = reorder(word, n)) %>%
ggplot(aes(x = word, y = freq , fill  = sentiment)) +
geom_col(show.legend = FALSE) +
facet_wrap(~ sentiment, scales = "free") +
coord_flip()
Emotion_sentiment_df %>%
sum(freq) %>%
group_by(sentiment) %>%
top_n(10) %>%
ungroup() %>%
mutate(word = reorder(word, n)) %>%
ggplot(aes(x = word, y = n , fill  = sentiment)) +
geom_col(show.legend = FALSE) +
facet_wrap(~ sentiment, scales = "free") +
coord_flip()
Emotion_sentiment_df %>%
sum(freq)
Emotion_sentiment_df
Emotion_sentiment_df %>%
sum(freq)
Emotion_sentiment_df %>%
count(sentiment)
Emotion_sentiment_df %>%
count(freq)
Emotion_sentiment_df %>%
#count(freq) %>%
group_by(sentiment) %>%
top_n(10) %>%
ungroup() %>%
mutate(word = reorder(word, freq)) %>%
ggplot(aes(x = word, y = freq , fill  = sentiment)) +
geom_col(show.legend = FALSE) +
facet_wrap(~ sentiment, scales = "free") +
coord_flip()
Emotion_sentiment_df %>%
group_by(sentiment) %>%
top_n(10,freq) %>%
ungroup() %>%
mutate(word = reorder(word, freq)) %>%
ggplot(aes(x = word, y = freq , fill  = sentiment)) +
geom_col(show.legend = FALSE) +
facet_wrap(~ sentiment, scales = "free") +
coord_flip()
Emotion_sentiment_df %>%
group_by(sentiment) %>%
top_n(10,freq) %>%
ungroup() %>%
mutate(word = reorder(word, freq)) %>%
ggplot(aes(x = word, y = freq , fill  = sentiment)) +
geom_col(show.legend = FALSE) +
facet_wrap(~ sentiment, scales = "free") +
coord_flip()+
ggtitle('Emotion based word frequency')+
xlab('Words')+ylab('Frequency')
Emotion_sentiment_df %>%
group_by(sentiment) %>%
top_n(10,freq) %>%
ungroup() %>%
mutate(word = reorder(word, freq)) %>%
ggplot(aes(x = word, y = freq , fill  = sentiment)) +
scale_fill_brewer(palette="RdYlGn")+
geom_col(show.legend = FALSE) +
facet_wrap(~ sentiment, scales = "free") +
coord_flip()+
ggtitle('Emotion based word frequency')+
xlab('Words')+ylab('Frequency')
?RColorBrewer
display.brewer.all()
Emotion_sentiment_df %>%
group_by(sentiment) %>%
top_n(10,freq) %>%
ungroup() %>%
mutate(word = reorder(word, freq)) %>%
ggplot(aes(x = word, y = freq , fill  = sentiment)) +
scale_fill_brewer(palette="Spectral")+
geom_col(show.legend = FALSE) +
facet_wrap(~ sentiment, scales = "free") +
coord_flip()+
ggtitle('Emotion based word frequency')+
xlab('Words')+ylab('Frequency')
floor_date
install.packages('lubridate')
require(lubridate)
if (Sys.getenv("JAVA_HOME")!="") Sys.setenv(JAVA_HOME="")
require(twitteR)
require(tm)
require(stringr)
require(qdap)
require(ggplot2)
require(wordcloud)
require(topicmodels)
require(tidytext)
require(dplyr)
if (Sys.getenv("JAVA_HOME")!="") Sys.setenv(JAVA_HOME="")
require(twitteR)
require(tm)
require(stringr)
require(qdap)
require(ggplot2)
require(wordcloud)
require(topicmodels)
require(tidytext)
require(dplyr)
consumerkey = "MTfL0uv6oBbtVBa3dPuR4PS51"
consumersecret = "T480vrOtvSK1XxGcPp20SdRoW99by3EGVvAapzyq8io0uH6lUh"
accesstoken = "191958252-uOisKMkvWHWmiTRQnf9d6XMww5wtZVtox1ShcjMm"
accesssecret = "9kTTYtORX4KnXk9SG4R9bQ1PpmQyBYEwmfvDksTh6Wht0"
