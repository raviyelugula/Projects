Originaldata=Originaldata[-(which(is.na(Originaldata$Planner.Group.code))),]
Originaldata$StateNames = Originaldata$State
Originaldata$Planner.Group.code = factor(Originaldata$Planner.Group.code,
labels = c(1:length(unique(Originaldata$Planner.Group.code))))
Originaldata$State = factor(Originaldata$State,
labels = c(1:22))
Originaldata$Product = factor(Originaldata$Product,
labels = c(1:length(unique(Originaldata$Product))))
set.seed(123)
kmeans = kmeans(x = Originaldata[11:12], centers = 4)
Originaldata$clusterCode = kmeans$cluster
Originaldata = Originaldata[,c(11,12,15,30,31,32)]
require(plyr)
require(dplyr)
require(ggplot2)
Originaldata = ddply(Originaldata, .(Planner.Group.code), mutate, count = length(unique(State)))
Originaldata %>%
ggplot(aes(x = State, y = Planner.Group.code,
color= factor(count),shape =factor(clusterCode)))+
geom_point()+
ggtitle('Cluster(Planner_Product) across states')+
xlab('State Codes')+ylab('Planner Codes')+
scale_x_discrete(labels = levels(factor(Originaldata$OrderState)))+
theme(axis.text.x = element_text(angle = 90, hjust = 1))
Originaldata %>%
ggplot(aes(x = State, y = Planner.Group.code,
color= factor(count)))+
geom_point()+
ggtitle('PlannerCodes across states')+
xlab('State Codes')+ylab('Planner Codes')+
#scale_x_discrete(labels = levels(factor(Originaldata$OrderState)))+
theme(axis.text.x = element_text(angle = 90, hjust = 1))
View(Originaldata)
View(Originaldata)
OrderState = read_excel('StateOrder.xlsx')
Originaldata = read.csv('Dataset_M.csv',header = T)
Originaldata$State = tolower(trimws(Originaldata$State))
Originaldata= Originaldata %>%
left_join(OrderState,by='State')
Originaldata=Originaldata[-(which(is.na(Originaldata$Planner.Group.code))),]
Originaldata$StateNames = Originaldata$State
OrderState = read_excel('StateOrder.xlsx')
Originaldata = read.csv('Dataset_M.csv',header = T)
Originaldata$State = tolower(trimws(Originaldata$State))
Originaldata= Originaldata %>%
left_join(OrderState,by='State')
Originaldata$StateNames = Originaldata$State
Originaldata$Planner.Group.code = factor(Originaldata$Planner.Group.code,
labels = c(1:length(unique(Originaldata$Planner.Group.code))))
OrderState = read_excel('StateOrder.xlsx')
Originaldata = read.csv('Dataset_M.csv',header = T)
Originaldata$State = tolower(trimws(Originaldata$State))
Originaldata= Originaldata %>%
left_join(OrderState,by='State')
Originaldata$StateNames = Originaldata$State
Originaldata$State = factor(Originaldata$State,
labels = c(1:22))
Originaldata$Product = factor(Originaldata$Product,
labels = c(1:length(unique(Originaldata$Product))))
set.seed(123)
kmeans = kmeans(x = Originaldata[11:12], centers = 4)
Originaldata$clusterCode = kmeans$cluster
Originaldata = Originaldata[,c(11,12,15,30,31,32)]
require(plyr)
OrderState = read_excel('StateOrder.xlsx')
Originaldata = read.csv('Dataset_M.csv',header = T)
Originaldata$State = tolower(trimws(Originaldata$State))
Originaldata= Originaldata %>%
left_join(OrderState,by='State')
Originaldata$StateNames = Originaldata$State
Originaldata$State = factor(Originaldata$State,
labels = c(1:22))
Originaldata$Product = factor(Originaldata$Product,
labels = c(1:length(unique(Originaldata$Product))))
names(Originaldata)
OrderState = read_excel('StateOrder.xlsx')
Originaldata = read.csv('Dataset_M.csv',header = T)
Originaldata$State = tolower(trimws(Originaldata$State))
Originaldata= Originaldata %>%
left_join(OrderState,by='State')
names(Originaldata)
Originaldata$Q1Factor = ifelse(Originaldata$Q1 %in% c(1,2,3),'NotSatisfied',
ifelse(Originaldata$Q1 %in% c(4,5),'Satisfied',Originaldata$Q1))
Originaldata$Q2Factor = ifelse(Originaldata$Q2 %in% c(1,2,3),'NotSatisfied',
ifelse(Originaldata$Q2 %in% c(4,5),'Satisfied',Originaldata$Q2))
Originaldata$Q3Factor = ifelse(Originaldata$Q3 %in% c(1,2,3),'NotSatisfied',
ifelse(Originaldata$Q3 %in% c(4,5),'Satisfied',Originaldata$Q3))
Originaldata$Q4Factor = ifelse(Originaldata$Q4 %in% c(1,2,3),'NotSatisfied',
ifelse(Originaldata$Q4 %in% c(4,5),'Satisfied',Originaldata$Q4))
Originaldata$Q5Factor = ifelse(Originaldata$Q5 %in% c(1,2,3),'NotSatisfied',
ifelse(Originaldata$Q5 %in% c(4,5),'Satisfied',Originaldata$Q5))
Originaldata$Q6Factor = ifelse(Originaldata$Q6 %in% c(1,2,3),'NotSatisfied',
ifelse(Originaldata$Q6 %in% c(4,5),'Satisfied',Originaldata$Q6))
Originaldata$Q7Factor = ifelse(Originaldata$Q7 %in% c(1,2,3),'NotSatisfied',
ifelse(Originaldata$Q7 %in% c(4,5),'Satisfied',Originaldata$Q7))
Originaldata$Q8Factor = ifelse(Originaldata$Q8 %in% c(1,2,3),'NotSatisfied',
ifelse(Originaldata$Q8 %in% c(4,5),'Satisfied',Originaldata$Q8))
Originaldata$Q9Factor = ifelse(Originaldata$Q9 %in% c(1,2,3),'NotSatisfied',
ifelse(Originaldata$Q9 %in% c(4,5),'Satisfied',Originaldata$Q9))
Originaldata$Q10Factor = ifelse(Originaldata$Q10 %in% c(1,2,3),'NotSatisfied',
ifelse(Originaldata$Q10 %in% c(4,5),'Satisfied',Originaldata$Q10))
names(Originaldata)
Originaldata %>%
ggplot(aes(x = State,y = Q1Factor))+
geom_bar()
Originaldata %>%
ggplot(aes(x = State,y = stat_count())+
geom_bar()
Originaldata %>%
ggplot(aes(x = State,y = stat_count()))+
geom_bar()
Originaldata %>%
ggplot(aes(Q10Factor))+
geom_bar()
Originaldata %>%
ggplot(aes(Q10Factor))+
facet_wrap(~State, scales = "free_x")
Originaldata %>%
group_by(State)%>%
ggplot(aes(Q10Factor))+
facet_wrap(~State, scales = "free_x")
Originaldata %>%
#group_by(State)%>%
ggplot(aes(Q10Factor))+
facet_wrap(~State, scales = "free_x")+
geom_bar()
Originaldata %>%
group_by(State)%>%
ggplot(aes(Q10Factor))+
facet_wrap(~State, scales = "free_x")+
geom_bar()
Originaldata %>%
group_by(State)%>%
ggplot(aes(Q10Factor))+
facet_wrap(~State, scales = "free_x")+
geom_bar()+
ggtitle('Question 10 Responses across states')+xlab('')+ylab('')
Originaldata %>%
group_by(State)%>%
ggplot(aes(Q10Factor))+
facet_wrap(~State, scales = "free_x")+
geom_bar()+
ggtitle('Question 10 Responses across states')+xlab('')+ylab('')
Originaldata %>%
group_by(State)%>%
ggplot(aes(Q9Factor))+
facet_wrap(~State, scales = "free_x")+
geom_bar()+
ggtitle('Question 09 Responses across states')+xlab('')+ylab('')
Originaldata %>%
group_by(State)%>%
ggplot(aes(Q8Factor))+
facet_wrap(~State, scales = "free_x")+
geom_bar()+
ggtitle('Question 08 Responses across states')+xlab('')+ylab('')
Originaldata %>%
group_by(State)%>%
ggplot(aes(Q7Factor))+
facet_wrap(~State, scales = "free_x")+
geom_bar()+
ggtitle('Question 07 Responses across states')+xlab('')+ylab('')
Originaldata %>%
group_by(State)%>%
ggplot(aes(Q6Factor))+
facet_wrap(~State, scales = "free_x")+
geom_bar()+
ggtitle('Question 06 Responses across states')+xlab('')+ylab('')
Originaldata %>%
group_by(State)%>%
ggplot(aes(Q5Factor))+
facet_wrap(~State, scales = "free_x")+
geom_bar()+
ggtitle('Question 05 Responses across states')+xlab('')+ylab('')
Originaldata %>%
group_by(State)%>%
ggplot(aes(Q4Factor))+
facet_wrap(~State, scales = "free_x")+
geom_bar()+
ggtitle('Question 04 Responses across states')+xlab('')+ylab('')
Originaldata %>%
group_by(State)%>%
ggplot(aes(Q3Factor))+
facet_wrap(~State, scales = "free_x")+
geom_bar()+
ggtitle('Question 03 Responses across states')+xlab('')+ylab('')
Originaldata %>%
group_by(State)%>%
ggplot(aes(Q2Factor))+
facet_wrap(~State, scales = "free_x")+
geom_bar()+
ggtitle('Question 02 Responses across states')+xlab('')+ylab('')
Originaldata %>%
group_by(State)%>%
ggplot(aes(Q1Factor))+
facet_wrap(~State, scales = "free_x")+
geom_bar()+
ggtitle('Question 01 Responses across states')+xlab('')+ylab('')
Originaldata %>%
ggplot(aes(State))+
geom_bar()
Originaldata %>%
ggplot(aes(State))+
geom_bar()+
theme(axis.text.x = element_text(angle = 90, hjust = 1))
Originaldata %>%
group_by(State)%>%
ggplot(aes(State))+
geom_bar()+
theme(axis.text.x = element_text(angle = 90, hjust = 1))
Originaldata %>%
ggplot(aes(State))+
geom_bar()+
ggtitle('State wise records count')+
theme(axis.text.x = element_text(angle = 90, hjust = 1))
Originaldata %>%
ggplot(aes(Year))+
geom_bar()+
ggtitle('Year wise records count')+
theme(axis.text.x = element_text(angle = 90, hjust = 1))
Originaldata %>%
group_by(Year)%>%
ggplot(aes(Q10Factor))+
facet_wrap(~Year, scales = "free_x")+
geom_bar()+
ggtitle('Question 10 Responses across Years')+xlab('')+ylab('')
Originaldata %>%
group_by(Year)%>%
ggplot(aes(Q9Factor))+
facet_wrap(~Year, scales = "free_x")+
geom_bar()+
ggtitle('Question 09 Responses across Years')+xlab('')+ylab('')
Originaldata %>%
group_by(Year)%>%
ggplot(aes(Q8Factor))+
facet_wrap(~Year, scales = "free_x")+
geom_bar()+
ggtitle('Question 08 Responses across Years')+xlab('')+ylab('')
Originaldata %>%
group_by(Year)%>%
ggplot(aes(Q7Factor))+
facet_wrap(~Year, scales = "free_x")+
geom_bar()+
ggtitle('Question 07 Responses across Years')+xlab('')+ylab('')
Originaldata %>%
group_by(Year)%>%
ggplot(aes(Q6Factor))+
facet_wrap(~Year, scales = "free_x")+
geom_bar()+
ggtitle('Question 06 Responses across Years')+xlab('')+ylab('')
Originaldata %>%
group_by(Year)%>%
ggplot(aes(Q5Factor))+
facet_wrap(~Year, scales = "free_x")+
geom_bar()+
ggtitle('Question 05 Responses across Years')+xlab('')+ylab('')
Originaldata %>%
group_by(Year)%>%
ggplot(aes(Q4Factor))+
facet_wrap(~Year, scales = "free_x")+
geom_bar()+
ggtitle('Question 04 Responses across Years')+xlab('')+ylab('')
Originaldata %>%
group_by(Year)%>%
ggplot(aes(Q10Factor))+
#facet_wrap(~Year, scales = "free_x")+
geom_line()+
ggtitle('Question 10 Responses across Years')+xlab('')+ylab('')
Originaldata %>%
group_by(Year)%>%
ggplot(aes(Q10Factor,Year))+
#facet_wrap(~Year, scales = "free_x")+
geom_line()+
ggtitle('Question 10 Responses across Years')+xlab('')+ylab('')
Originaldata %>%
group_by(Year)%>%
ggplot(aes(Year,Q10Factor))+
#facet_wrap(~Year, scales = "free_x")+
geom_line()+
ggtitle('Question 10 Responses across Years')+xlab('')+ylab('')
Originaldata %>%
group_by(Q10Factor)%>%
ggplot(aes(Year,Q10Factor))+
#facet_wrap(~Year, scales = "free_x")+
geom_line()+
ggtitle('Question 10 Responses across Years')+xlab('')+ylab('')
OrderState = read_excel('StateOrder.xlsx')
Originaldata = read.csv('Dataset_M.csv',header = T)
Originaldata$State = tolower(trimws(Originaldata$State))
Originaldata= Originaldata %>%
left_join(OrderState,by='State')
Originaldata=Originaldata[-(which(is.na(Originaldata$Planner.Group.code))),]
Originaldata$StateNames = Originaldata$State
Originaldata$Planner.Group.code = factor(Originaldata$Planner.Group.code,
labels = c(1:length(unique(Originaldata$Planner.Group.code))))
iris
head(iris)
iris.tidy <- iris %>%
gather(key,value, -Species) %>%
separate(key, c("Part","Measure"), '\\.')
library("ggplot2")
iris.tidy <- iris %>%
gather(key,value, -Species) %>%
separate(key, c("Part","Measure"), '\\.')
library(tidyr)
iris.tidy <- iris %>%
gather(key,value, -Species) %>%
separate(key, c("Part","Measure"), '\\.')
head(iris.tidy)
head(iris)
OrderState = read_excel('StateOrder.xlsx')
Originaldata = read.csv('Dataset_M.csv',header = T)
Originaldata$State = tolower(trimws(Originaldata$State))
Originaldata= Originaldata %>%
left_join(OrderState,by='State')
Originaldata$Q1Factor = ifelse(Originaldata$Q1 %in% c(1,2,3),'NotSatisfied',
ifelse(Originaldata$Q1 %in% c(4,5),'Satisfied',Originaldata$Q1))
Originaldata$Q2Factor = ifelse(Originaldata$Q2 %in% c(1,2,3),'NotSatisfied',
ifelse(Originaldata$Q2 %in% c(4,5),'Satisfied',Originaldata$Q2))
Originaldata$Q3Factor = ifelse(Originaldata$Q3 %in% c(1,2,3),'NotSatisfied',
ifelse(Originaldata$Q3 %in% c(4,5),'Satisfied',Originaldata$Q3))
Originaldata$Q4Factor = ifelse(Originaldata$Q4 %in% c(1,2,3),'NotSatisfied',
ifelse(Originaldata$Q4 %in% c(4,5),'Satisfied',Originaldata$Q4))
Originaldata$Q5Factor = ifelse(Originaldata$Q5 %in% c(1,2,3),'NotSatisfied',
ifelse(Originaldata$Q5 %in% c(4,5),'Satisfied',Originaldata$Q5))
Originaldata$Q6Factor = ifelse(Originaldata$Q6 %in% c(1,2,3),'NotSatisfied',
ifelse(Originaldata$Q6 %in% c(4,5),'Satisfied',Originaldata$Q6))
Originaldata$Q7Factor = ifelse(Originaldata$Q7 %in% c(1,2,3),'NotSatisfied',
ifelse(Originaldata$Q7 %in% c(4,5),'Satisfied',Originaldata$Q7))
Originaldata$Q8Factor = ifelse(Originaldata$Q8 %in% c(1,2,3),'NotSatisfied',
ifelse(Originaldata$Q8 %in% c(4,5),'Satisfied',Originaldata$Q8))
Originaldata$Q9Factor = ifelse(Originaldata$Q9 %in% c(1,2,3),'NotSatisfied',
ifelse(Originaldata$Q9 %in% c(4,5),'Satisfied',Originaldata$Q9))
Originaldata$Q10Factor = ifelse(Originaldata$Q10 %in% c(1,2,3),'NotSatisfied',
ifelse(Originaldata$Q10 %in% c(4,5),'Satisfied',Originaldata$Q10))
Originaldata %>%
group_by(State)%>%
ggplot(aes(Q10Factor))+
facet_wrap(~State, scales = "free_x")+
geom_bar()+
ggtitle('Question 10 Responses across states')+xlab('')+ylab('')
Originaldata %>%
group_by(State)%>%
ggplot(aes(Q9Factor))+
facet_wrap(~State, scales = "free_x")+
geom_bar()+
ggtitle('Question 09 Responses across states')+xlab('')+ylab('')
Originaldata %>%
group_by(State)%>%
ggplot(aes(Q8Factor))+
facet_wrap(~State, scales = "free_x")+
geom_bar()+
ggtitle('Question 08 Responses across states')+xlab('')+ylab('')
Originaldata %>%
group_by(State)%>%
ggplot(aes(Q7Factor))+
facet_wrap(~State, scales = "free_x")+
geom_bar()+
ggtitle('Question 07 Responses across states')+xlab('')+ylab('')
Originaldata %>%
group_by(State)%>%
ggplot(aes(Q6Factor))+
facet_wrap(~State, scales = "free_x")+
geom_bar()+
ggtitle('Question 06 Responses across states')+xlab('')+ylab('')
Originaldata %>%
group_by(State)%>%
ggplot(aes(Q5Factor))+
facet_wrap(~State, scales = "free_x")+
geom_bar()+
ggtitle('Question 05 Responses across states')+xlab('')+ylab('')
Originaldata %>%
group_by(State)%>%
ggplot(aes(Q4Factor))+
facet_wrap(~State, scales = "free_x")+
geom_bar()+
ggtitle('Question 04 Responses across states')+xlab('')+ylab('')
Originaldata %>%
group_by(State)%>%
ggplot(aes(Q3Factor))+
facet_wrap(~State, scales = "free_x")+
geom_bar()+
ggtitle('Question 03 Responses across states')+xlab('')+ylab('')
Originaldata %>%
group_by(State)%>%
ggplot(aes(Q2Factor))+
facet_wrap(~State, scales = "free_x")+
geom_bar()+
ggtitle('Question 02 Responses across states')+xlab('')+ylab('')
Originaldata %>%
group_by(State)%>%
ggplot(aes(Q1Factor))+
facet_wrap(~State, scales = "free_x")+
geom_bar()+
ggtitle('Question 01 Responses across states')+xlab('')+ylab('')
Originaldata %>%
ggplot(aes(State))+
geom_bar()+
ggtitle('State wise records count')+
theme(axis.text.x = element_text(angle = 90, hjust = 1))
Originaldata %>%
ggplot(aes(Year))+
geom_bar()+
ggtitle('Year wise records count')+
theme(axis.text.x = element_text(angle = 90, hjust = 1))
Originaldata %>%
group_by(Q10Factor)%>%
ggplot(aes(Year,Q10Factor))+
#facet_wrap(~Year, scales = "free_x")+
geom_line()+
ggtitle('Question 10 Responses across Years')+xlab('')+ylab('')
Originaldata %>%
group_by(Year)%>%
ggplot(aes(Q9Factor))+
facet_wrap(~Year, scales = "free_x")+
geom_bar()+
ggtitle('Question 09 Responses across Years')+xlab('')+ylab('')
Originaldata %>%
group_by(Year)%>%
ggplot(aes(Q8Factor))+
facet_wrap(~Year, scales = "free_x")+
geom_bar()+
ggtitle('Question 08 Responses across Years')+xlab('')+ylab('')
Originaldata %>%
group_by(Year)%>%
ggplot(aes(Q7Factor))+
facet_wrap(~Year, scales = "free_x")+
geom_bar()+
ggtitle('Question 07 Responses across Years')+xlab('')+ylab('')
Originaldata %>%
group_by(Year)%>%
ggplot(aes(Q6Factor))+
facet_wrap(~Year, scales = "free_x")+
geom_bar()+
ggtitle('Question 06 Responses across Years')+xlab('')+ylab('')
Originaldata %>%
group_by(Year)%>%
ggplot(aes(Q5Factor))+
facet_wrap(~Year, scales = "free_x")+
geom_bar()+
ggtitle('Question 05 Responses across Years')+xlab('')+ylab('')
Originaldata %>%
group_by(Year)%>%
ggplot(aes(Q4Factor))+
facet_wrap(~Year, scales = "free_x")+
geom_bar()+
ggtitle('Question 04 Responses across Years')+xlab('')+ylab('')
Originaldata %>%
group_by(Year)%>%
ggplot(aes(Q3Factor))+
facet_wrap(~Year, scales = "free_x")+
geom_bar()+
ggtitle('Question 03 Responses across Years')+xlab('')+ylab('')
Originaldata %>%
group_by(Year)%>%
ggplot(aes(Q2Factor))+
facet_wrap(~Year, scales = "free_x")+
geom_bar()+
ggtitle('Question 02 Responses across Years')+xlab('')+ylab('')
Originaldata %>%
group_by(Year)%>%
ggplot(aes(Q1Factor))+
facet_wrap(~Year, scales = "free_x")+
geom_bar()+
ggtitle('Question 01 Responses across Years')+xlab('')+ylab('')
names(Originaldata)
Originaldata_Sub = Originaldata[,c(4,31)]
Originaldata_Sub %>%
gather(key,value,-Year) %>%
separate(key,c('NotSatified','Satisfied'))
Originaldata %>%
group_by(Q10Factor)%>%
ggplot(aes(Year,Q10Factor))+
#facet_wrap(~Year, scales = "free_x")+
geom_line()+
ggtitle('Question 10 Responses across Years')+xlab('')+ylab('')
Originaldata %>%
group_by(Q10Factor)%>%
mutate(count(Q10Factor))%>%
ggplot(aes(Year,Q10Factor))+
#facet_wrap(~Year, scales = "free_x")+
geom_line()+
ggtitle('Question 10 Responses across Years')+xlab('')+ylab('')
Originaldata %>%
group_by(Q10Factor)%>%
ggplot(aes(Year,..count..))+
#facet_wrap(~Year, scales = "free_x")+
geom_line()+
ggtitle('Question 10 Responses across Years')+xlab('')+ylab('')
Originaldata %>%
group_by(Q10Factor)%>%
qplot(aes(Year,..count..))+
#facet_wrap(~Year, scales = "free_x")+
geom_line()+
ggtitle('Question 10 Responses across Years')+xlab('')+ylab('')
qplot(Year,..count..,data = Originaldata_Sub,
geom = 'line')
qplot(Year,..count..,data = Originaldata_Sub,
geom = 'density')
qplot(Year,..count..,data = Originaldata_Sub,
geom = 'line')
qplot(Year,..count..,data = Originaldata_Sub,
geom = 'bar')
qplot(Year,..count..,data = Originaldata_Sub,
geom = 'point')
qplot(Year,..count..,data = Originaldata_Sub,
geom = 'bar')
Originaldata %>%
group_by(Year)%>%
ggplot(aes(Q9Factor))+
facet_wrap(~Year, scales = "free_x")+
geom_bar()+
ggtitle('Question 09 Responses across Years')+xlab('')+ylab('')
